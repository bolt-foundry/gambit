"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.useClientSideDefer = useClientSideDefer;
const react_disposable_state_1 = require("@isograph/react-disposable-state");
const cache_1 = require("../core/cache");
const IsographEnvironmentProvider_1 = require("../react/IsographEnvironmentProvider");
function useClientSideDefer(loadableField, args, fetchOptions) {
    const [id, loader] = loadableField(args, fetchOptions !== null && fetchOptions !== void 0 ? fetchOptions : {});
    const environment = (0, IsographEnvironmentProvider_1.useIsographEnvironment)();
    const cache = (0, cache_1.getOrCreateItemInSuspenseCache)(environment, id, loader);
    const fragmentReference = (0, react_disposable_state_1.useLazyDisposableState)(cache).state;
    return { fragmentReference };
}
